<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>AWS ADT Tutorials Hardcore Temporal Joomla | Codebreakers</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="AWS ADT Tutorials Hardcore Temporal Joomla" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The Agile Deployment Toolkit AWS Tutorials Hardcore Temporal Joomla" />
<meta property="og:description" content="The Agile Deployment Toolkit AWS Tutorials Hardcore Temporal Joomla" />
<link rel="canonical" href="https://www.codebreakers.uk/adtawstutorialshardcoretemporal/" />
<meta property="og:url" content="https://www.codebreakers.uk/adtawstutorialshardcoretemporal/" />
<meta property="og:site_name" content="Codebreakers" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-11-01T00:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2021-11-01T00:00:00-05:00","url":"https://www.codebreakers.uk/adtawstutorialshardcoretemporal/","@type":"BlogPosting","headline":"AWS ADT Tutorials Hardcore Temporal Joomla","dateModified":"2021-11-01T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.codebreakers.uk/adtawstutorialshardcoretemporal/"},"description":"The Agile Deployment Toolkit AWS Tutorials Hardcore Temporal Joomla","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://www.codebreakers.uk/feed.xml" title="Codebreakers" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Codebreakers</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">AWS ADT Tutorials Hardcore Temporal Joomla</h1><p class="page-description">The Agile Deployment Toolkit AWS Tutorials Hardcore Temporal Joomla</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-11-01T00:00:00-05:00" itemprop="datePublished">
        Nov 1, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="//categories/#agiledeploymenttoolkit">agiledeploymenttoolkit</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><strong>YOU MUST HAVE THE MACHINES STILL RUNNING FROM THE PREVIOUS TUTORIAL TO COMPLETE THIS TUTORIAL SUCCESSFULLY</strong></p>

<p>On your build machine, you need to now make temporal backups of your application sourcecode and your application database.
You do this as follows:</p>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd /home/&lt;your username&gt;/agile-infrastructure-build-client-scripts/helperscripts
</code></pre></div>  </div>
</blockquote>

<p>Then perform a temporal database backup</p>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/bin/sh PerformDatabaseBackup.sh
</code></pre></div>  </div>
</blockquote>

<p>Answering all of the questions and picking a periodicity, for example, HOURLY (make sure DISABLE_HOURLY=0) in your template</p>

<p>Then perform a temporal website sourcecode backup</p>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/bin/sh PerformWebsiteBackup.sh
</code></pre></div>  </div>
</blockquote>

<p>Making sure you pick the same periodicity as for the temporal database backup, for example, “HOURLY”</p>

<p>What we are then interested in is template 3 which is at:</p>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/home/agile-deployer/agile-infrastructure-build-client-scripts/templatedconfigurations/templates/aws/aws3.tmpl
</code></pre></div>  </div>
</blockquote>

<p>I can extract the values for the following variables from template 1 or template 2 which I used in the previous tutorial and set them in template 3, replace these with your own live values:</p>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export S3_ACCESS_KEY="AAAAA"  #MANDATORY
export S3_SECRET_KEY="BBBBB"  #MANDATORY
export ACCESS_KEY="XXXXX"   #MANDATORY
export SECRET_KEY="YYYYY"   #MANDATORY
export DNS_USERNAME="testemail@testemail.com"  #MANDATORY
export DNS_SECURITY_KEY="CCCCC:DDDDD"   #MANDATORY - This is your access key and your secret key, written: DNS_SECURITY_KEY="${ACCESS_KEY}:${SECRET_KEY}"
export CLOUDHOST_EMAIL_ADDRESS="testemail@testemail.com" #MANDATORY
export WEBSITE_DISPLAY_NAME="Test Social Network" #MANDATORY
export WEBSITE_NAME="testsocialnetwork" #MANDATORY - This is the exact value of the core of your WEBSITE_URL, for example, www.nuocial.org.uk would be nuocial
export WEBSITE_URL="www.testsocialnetwork.org.uk"  #MANDATORY
export APPLICATION_REPOSITORY_OWNER="mytestgituser" #MANDATORY
export APPLICATION_REPOSITORY_USERNAME="mytestgituser" #MANDATORY
export APPLICATION_REPOSITORY_TOKEN="KKKKK" #MANDATORY
</code></pre></div>  </div>
</blockquote>

<p>What I then do is adjust</p>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/home/agile-deployer/agile-infrastructure-build-client-scripts/templatedconfigurations/templates/aws/aws3.tmpl  
</code></pre></div>  </div>
</blockquote>

<p>to contain these values instead of its defaults.</p>

<p>I then need to set the template to use the temporal backups that I have generated and I do that by setting these values in template3:</p>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export APPLICATION="joomla" #MANDATORY (joomla or wordpress or drupal or moodle)
export BUILD_CHOICE="2" #MANDATORY 2=hourly, 3=daily, 4=weekly, 5=monthly, 6=bimonthly
export BUILD_ARCHIVE_CHOICE="hourly" #MANDATORY hourly, daily, weekly, monthly, bimonthly
export PERSIST_ASSETS_TO_CLOUD="1" #MANDATORY This should only be 0 if your application has a very small number of assets
export DIRECTORIES_TO_MOUNT="images" #MANDATORY - this will define which directories in your webroot will be mounted from S3, if PERSIST_ASSETS_TO_CLOUD=1
</code></pre></div>  </div>
</blockquote>

<p>Shutdown any webservers that you have running from tutorial 2 and you are then ready to perform a temporal build, as shown below:</p>

<p>You can make any other adjustments you want like if you want to choose APACHE instead of NGINX or change the size of the machines (you can find out about such things in the specification).</p>

<p><strong>FOLLOW THESE STEPS ON YOUR LAPTOP IF YOU DON’T HAVE A BUILD SERVER RUNNING</strong></p>

<p>You now need to copy your template as follows on your laptop:</p>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/bin/cp ./agile-infrastructure-build-client-scripts/templatedconfigurations/templates/aws/aws2.tmpl ./agile-infrastructure-build-client-scripts/overridescripts/aws2override.tmpl  
</code></pre></div>  </div>
</blockquote>

<p>Then you need to run the script:</p>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd helperscripts
</code></pre></div>  </div>
</blockquote>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./GenerateHardcoreUserDataScript.sh
</code></pre></div>  </div>
</blockquote>

<p>This will leave you with a script:</p>

<blockquote>
  <p>../userdatascripts/${userdatascript}</p>
</blockquote>

<p>where ${userdatascript} is the descriptive name you gave when prompted.</p>

<p>It is mandatory to edit your userdata script and modify these values within it to your liking:</p>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export BUILDMACHINE_USER="agile-user"
export BUILDMACHINE_PASSWORD="Hjdhfb34hd£" #Make sure any password you choose is strong enough to pass any strength enforcement rules of your OS
export BUILDMACHINE_SSH_PORT="1035"
export LAPTOP_IP="111.111.111.111"
</code></pre></div>  </div>
</blockquote>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export SSH=\"\" #paste your public key here
</code></pre></div>  </div>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Now you have your userdata script take a copy of it using copy and paste and then follow [these](https://www.codebreakers.uk/adtawstutorialsbuildmachinehardcore) instructions PASTING THE SCRIPT YOU HAVE JUST COPIED INTO THE USERDATA AREA OF YOUR AWS MACHINE INSTEAD OF THE MODIFIED TEMPLATE. The build machine will then install **AND**  run the agile deployment toolkit. This is just an alternative method to the expedited build process which you may or may not perfer.
</code></pre></div></div>

<p>At this point, your build machine should be up and running. Please review</p>

<p><a href="https://github.com/agile-deployer/agile-infrastructure-build-client-scripts/blob/master/doco/AgileToolkitDeployment/TightenBuildMachineAccess.md">Tighten Build Machine</a></p>

<p>At this point, your build machine will only accept connections from your laptop. If you need access from other ip addresses you need to use the technique described in “Tightening Build Machine Access” to grant access to additional IP addresses. This will be the case every time your laptop changes its IP address as you travel about, so, you might want to setup and configure an S3 client on your laptop to enable you to grant access to new IP addresses easily.</p>

<p>If all has gone according to plan, you will have seen a full deployment of your temporal backup.</p>

<hr />
<p><strong>DEPLOYMENT USING MANAGED DATABASES</strong></p>

<p>There’s something else to be aware of, if you want to deploy a managed DBaaS system instead of just using the one that is built in to the build process you can do that as detailed in <a href="https://github.com/agile-deployer/agile-infrastructure-build-client-scripts/blob/master/doco/AgileToolkitDeployment/DeployingDBaaS-Shortcut.md">this</a> and <a href="https://github.com/agile-deployer/agile-infrastructure-build-client-scripts/blob/master/doco/AgileToolkitDeployment/DeployingDBaaS.md">this</a> document</p>

<hr />
<p><strong>DEPLOYMENT USING SNAPSHOTS</strong></p>

<p>You can also build your webservers using snapshots that you generate and then use. You can read about how to perform snapshot builds <a href="https://github.com/agile-deployer/agile-infrastructure-build-client-scripts/blob/master/doco/AgileToolkitDeployment/SnapshotsWorkflow.md">here</a>.</p>

<hr />
<p><strong>OTHER APPLICATION TYPES</strong></p>

<p>In order to do a temporaly build from backups you have made for a different application type (wordpress, drupal or moodle) you will need to alter the following variables in your template compared to what you have used above:</p>

<p>For Wordpress:</p>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export APPLICATION="wordpress"
export DIRECTORIES_TO_MOUNT="wp-content.uploads"
</code></pre></div>  </div>
</blockquote>

<p>For Drupal:</p>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export APPLICATION="drupal"
export DIRECTORIES_TO_MOUNT="sites.default.files"
</code></pre></div>  </div>
</blockquote>

<p>For Moodle:</p>

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export APPLICATION="moodle"
export DIRECTORIES_TO_MOUNT="moodledata.filedir"
</code></pre></div>  </div>
</blockquote>

  </div><a class="u-url" href="/adtawstutorialshardcoretemporal/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>The main website for the codebreakers project</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" target="_blank" title="fastai"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" target="_blank" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
